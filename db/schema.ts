// ======================================================================
// üìö DRIZZLE SCHEMA - –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
// ======================================================================
//
// –≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL.
// Drizzle –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –¥–ª—è:
// 1. –°–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
// 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ TypeScript —Ç–∏–ø–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
// 3. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
//
// –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
// npx drizzle-kit generate - —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–∏
// npx drizzle-kit migrate - –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –ë–î
// ======================================================================

import {
  pgTable,       // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã PostgreSQL
  serial,        // –ê–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π integer (–¥–ª—è id)
  varchar,       // –°—Ç—Ä–æ–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –¥–ª–∏–Ω—ã
  text,          // –¢–µ–∫—Å—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã
  decimal,       // –¢–æ—á–Ω–æ–µ —á–∏—Å–ª–æ –¥–ª—è –¥–µ–Ω–µ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  integer,       // –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
  timestamp,     // –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
} from 'drizzle-orm/pg-core';

// ======================================================================
// üì¶ –¢–ê–ë–õ–ò–¶–ê –ö–ê–¢–ï–ì–û–†–ò–ô (categories)
// ======================================================================
// –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤: –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞, –û–¥–µ–∂–¥–∞, –ö–Ω–∏–≥–∏ –∏ —Ç.–¥.

export const categories = pgTable('categories', {
  // id - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
  // serial = –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç (1, 2, 3, ...)
  id: serial('id').primaryKey(),
  
  // –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ, –¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤)
  name: varchar('name', { length: 100 }).notNull().unique(),
  
  // –û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ)
  description: text('description'),
  
  // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è)
  createdAt: timestamp('created_at').defaultNow().notNull(),
});

// ======================================================================
// üõçÔ∏è –¢–ê–ë–õ–ò–¶–ê –¢–û–í–ê–†–û–í (products)
// ======================================================================
// –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –º–∞–≥–∞–∑–∏–Ω–∞

export const products = pgTable('products', {
  // id - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞
  id: serial('id').primaryKey(),
  
  // –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)
  name: varchar('name', { length: 200 }).notNull(),
  
  // –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞)
  description: text('description'),
  
  // –¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞
  // decimal(10, 2) = –¥–æ 10 —Ü–∏—Ñ—Ä –≤—Å–µ–≥–æ, 2 –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
  // –ü—Ä–∏–º–µ—Ä—ã: 99.99, 1234567.89
  price: decimal('price', { precision: 10, scale: 2 }).notNull(),
  
  // URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–æ–≤–∞—Ä–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)
  imageUrl: varchar('image_url', { length: 500 }),
  
  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
  stock: integer('stock').default(0).notNull(),
  
  // –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ —Ç–∞–±–ª–∏—Ü—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  // references() —Å–æ–∑–¥–∞—ë—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
  categoryId: integer('category_id').references(() => categories.id),
  
  // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
  createdAt: timestamp('created_at').defaultNow().notNull(),
  
  // –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  updatedAt: timestamp('updated_at').defaultNow().notNull(),
});

// ======================================================================
// üìù –¢–ò–ü–´ TYPESCRIPT
// ======================================================================
// Drizzle –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Ç–∏–ø—ã –∏–∑ —Å—Ö–µ–º—ã.
// –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–∏ —Ç–∏–ø—ã –≤ —Å–≤–æ—ë–º –∫–æ–¥–µ –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

// –ò–º–ø–æ—Ä—Ç —Ç–∏–ø–æ–≤ –∏–∑ Drizzle
import { InferSelectModel, InferInsertModel } from 'drizzle-orm';

// –¢–∏–ø –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –ë–î (–≤—Å–µ –ø–æ–ª—è)
export type Category = InferSelectModel<typeof categories>;

// –¢–∏–ø –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–±–µ–∑ id –∏ createdAt)
export type NewCategory = InferInsertModel<typeof categories>;

// –¢–∏–ø –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –∏–∑ –ë–î
export type Product = InferSelectModel<typeof products>;

// –¢–∏–ø –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
export type NewProduct = InferInsertModel<typeof products>;

